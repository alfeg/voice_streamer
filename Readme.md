# VoiceStreamer

VoiceStreamer — это приложение, которое отслеживает голосовые сообщения в публичных Telegram-каналах и транслирует их на RTMP-сервер (Telegram или пользовательский). Приложение настраивается с использованием Microsoft Configuration Framework и может быть легко запущено с помощью Docker Compose.

## Возможности

- Отслеживание голосовых сообщений в указанном Telegram-канале.
- Трансляция голосовых сообщений в реальном времени на RTMP-сервер.
- Настраивается через файл `.env`/`.env.prod` для удобства использования.

## Требования

- Установленные Docker и Docker Compose.
- Аккаунт Telegram с доступом к каналу, который вы хотите отслеживать.
- Данные RTMP-сервера (например, RTMP-сервер Telegram или пользовательский).

## Настройка

### 1. Клонирование репозитория

Клонируйте репозиторий на ваш локальный компьютер:

```bash
git clone <repository-url>
cd VoiceStreamer
```

### 2. Настройка Telegram-аккаунта

Для работы приложения необходимо получить `ApiHash` и `ApiId` от Telegram. Следуйте этим шагам:

1. **Создайте Telegram-аккаунт**  
   Если у вас еще нет аккаунта Telegram, скачайте приложение Telegram (доступно для [iOS](https://apps.apple.com/app/telegram-messenger/id686449807), [Android](https://play.google.com/store/apps/details?id=org.telegram.messenger), [Windows](https://desktop.telegram.org/), [macOS](https://macos.telegram.org/)) и зарегистрируйтесь, используя ваш номер телефона.

2. **Зайдите на Telegram API**  
   Перейдите на [страницу Telegram API](https://my.telegram.org/).

3. **Авторизуйтесь**  
   Войдите, используя ваш номер телефона, связанный с Telegram-аккаунтом. Telegram отправит вам код подтверждения в приложении.

4. **Создайте новое приложение**  
   - После входа выберите вкладку **API Development Tools**.
   - Нажмите **Create New Application**.
   - Заполните форму:
     - **App title**: Укажите название вашего приложения (например, `VoiceStreamer`).
     - **Short name**: Укажите короткое имя (например, `voicestreamer`).
     - Остальные поля заполните по вашему усмотрению.
   - Нажмите **Create**.

5. **Получите `ApiId` и `ApiHash`**  
   После создания приложения вы увидите ваш `ApiId` и `ApiHash`. Сохраните их, так как они понадобятся для настройки `.env` файла.

6. **Укажите данные в `.env.prod`**  
   Добавьте полученные значения в файл `.env.prod`:

   ```env
   Telegram__ApiId=ВАШ_API_ID
   Telegram__ApiHash=ВАШ_API_HASH
   ```

### 3. Настройка трансляции в Telegram

Для трансляции в Telegram вам потребуется RTMP-сервер Telegram и ключ трансляции. Следуйте этим шагам:

1. **Создайте трансляцию в Telegram**  
   - Откройте Telegram и перейдите в ваш канал или группу, где вы хотите запустить трансляцию.
   - Нажмите на название канала/группы в верхней части экрана.
   - Выберите **Трансляция** (или **Live Stream**, если интерфейс на английском).
   - Нажмите **Начать трансляцию**.

2. **Получите RTMP-сервер и ключ трансляции**  
   - После запуска трансляции Telegram предоставит вам URL RTMP-сервера и ключ трансляции.
   - Пример:
     - RTMP-сервер: `rtmp://dc2-1.rtmp.t.me/s`
     - Ключ трансляции: `your-stream-key`

3. **Укажите данные в `.env.prod`**  
   Добавьте RTMP-сервер и ключ трансляции в файл `.env.prod`:

   ```env
   Streamer__RtmpServerUrl=rtmp://dc2-1.rtmp.t.me/s
   Streamer__RtmpStreamKey=your-stream-key
   ```

### 4. Авторизация пользователя

Для работы приложения необходимо авторизоваться в Telegram. Следуйте этим шагам:

1. **Укажите номер телефона в `.env.prod`**  
   В файле `.env.prod` обязательно укажите номер телефона, привязанный к вашему Telegram-аккаунту:

   ```env
   Telegram__PhoneNumber=+7xxxxxxxxxx
   ```
2. **Запустите приложение**

   При первом запуске приложение попытается авторизоваться в Telegram. Telegram отправит код авторизации на указанный номер телефона.

3. **Укажите код авторизации**

   После получения кода авторизации добавьте его в файл `.env.prod` в переменную

   ```env
   Telegram__Code=ВАШ_КОД_ИЗ_ТЕЛЕГРАМ
   ```

4. **Перезапустите приложение**

   Перезапустите приложение, чтобы завершить процесс авторизации:

   ```
   docker-compose down
   docker-compose up --build
   ```


